
 
$(document).on('click', 'a.js-link', scrollToLink);
$(document).on('click', 'a.js-link-top', scrollToLink);

function scrollToLink() {
    $("html, body").animate({
        scrollTop: $($(this).attr("href")).offset().top - 40 + "px"
    }, {
        duration: 400,
        easing: "swing"
        });
    return false;
}
// js-form-service
$('*[data-service]').click( function(e) {  
    $('#js-form-service')[0].value = $(e.currentTarget).attr('data-service')
})
 
// header btn click function
$(document).ready(function () {
    $("header a.js-link").click(function (e) {
        e.preventDefault(); 
        $('.navbar-collapse.show').collapse('hide');
        $('.js-navbar-toggle span').toggleClass('d-none')
    $('.js-navbar-toggle svg').toggleClass('d-none') 
    });
});
      
$('.js-navbar-toggle').click( headerBtnTimes)

function headerBtnTimes() { 
  $('.js-navbar-toggle span').toggleClass('d-none')
  $('.js-navbar-toggle svg').toggleClass('d-none')
}
 
$('#myModal').on('shown.bs.modal', function () {
    $('#myInput').trigger('focus')
})
 
new Selectr('#yourcity', { 
    searchable: false
}); 

let  swiperData = [
    'Ноутбук lenovo ideapad l340',
    'Ноутбук lenovo ideapad 520',
    'Моноблок lenovo thinkcenter',
    'Ноутбук lenovo thinkcenter m625q'
]


var swiper = new Swiper('.swiper-container', {
    loop: true,
    slidesPerView: 1,  
    navigation: {
        nextEl: '.swiper-button-next',
        prevEl: '.swiper-button-prev',
    },
    pagination: {
        el: '.swiper-pagination',
        clickable: true,
        renderBullet: function (index, className) {
        return '<span class="' + className + '">' + swiperData[index] + '</span>';
        },
    },
});

//задать всем слайдам высоту как у контейнера
let height = $('.swiper-wrapper').innerHeight() + 10 

function setSlideHeight() {  
    if($(document).innerWidth() < 768) {   
        $('.swiper-slide').innerHeight(height) 
    }
}
 
setSlideHeight()

$(window).resize( () => { 
    setSlideHeight() 
})


// header sticty function
$(window).scroll(setScrollHeader);

$(window).on('load', setScrollHeader)

function setScrollHeader() {
    if ($(this).scrollTop() > 1){  
        $('header').addClass("sticky");
    }
    else{
        $('header').removeClass("sticky");
    }
}
;(function(){

            
    let dis = document.querySelector('.timer');
    let hour = document.querySelector('.timer .hour');
    let minute = document.querySelector('.timer .minute');
    let second = document.querySelector('.timer .second');
    let finishTime;
    let savedTime;
    let timerLength = 3600 * 1000
    let timeoutID;


    if(localStorage.getItem('timerFinishTime')){
        UpdateTimer(); 
        
    }else{
        UpdateTimerDis(timerLength);
    }
    

    if(localStorage.getItem('timerSavedTime')){
        let savedTime = localStorage.getItem('timerSavedTime') * 1;
    UpdateTimerDis(savedTime);
    }

    function UpdateTimer() {
        finishTime = localStorage.getItem('timerFinishTime');
        let timeLeft = (finishTime - new Date());
        
            if(timeLeft > 0){
                timeoutID = window.setTimeout(UpdateTimer, 1000);
            }else{
                timeLeft = 0;
                if (timeoutID != undefined) window.clearTimeout(timeoutID);
                 
                localStorage.removeItem('timerIsRunning');
                localStorage.removeItem('timerFinishTime');
                localStorage.removeItem('timerSavedTime');
                timerLength = 3600 * 1000
            }
            UpdateTimerDis(timeLeft);
    }

    function UpdateTimerDis(millis) {
        millisToMinutesAndSeconds(millis); 
    }

    function StartTimer() { 
        
        if(localStorage.getItem('timerSavedTime')){
            savedTime = localStorage.getItem('timerSavedTime') * 1;
            localStorage.removeItem('timerSavedTime');
        }else{
            savedTime = timerLength;
        }
        
        localStorage.setItem('timerIsRunning', true);
        localStorage.setItem('timerFinishTime', ((new Date()).getTime() + savedTime));
        if (timeoutID != undefined) window.clearTimeout(timeoutID);
        UpdateTimer();
    } 

    function millisToMinutesAndSeconds(millis) {
            let hours = Math.floor(millis / 3600000);
            if(hours < 1){
                hours = '00';
            }
            if(hours === '00') { 
                hour.classList.add('zero-text')
            }   else {  
                hour.classList.remove('zero-text')
            }

            let minutes = (Math.floor(millis / 60000))-(hours*60);
            if(minutes > 59){
                minutes = 0;
            }
            if (minutes < 10) {
                minutes = '0' + minutes
            }
            if(minutes === '00') { 
                minute.classList.add('zero-text')
            }   else {  
                minute.classList.remove('zero-text')
            }


            let seconds = ((millis % 60000) / 1000).toFixed(0);
            if(seconds > 59){
                seconds = 0;
            }
            if (seconds < 10) {
                seconds = '0' + seconds
            }
            if(seconds === '00') { 
                second.classList.add('zero-text')
            }   else {  
                second.classList.remove('zero-text')
            }

            writeTimeInDom(hours, minutes, seconds) 
    }

    function writeTimeInDom(hours, minutes, seconds) { 
        hour.innerHTML = hours
        minute.innerHTML = minutes
        second.innerHTML = seconds
    }
    if(localStorage.getItem('timerFinishTime') === null  ){
        StartTimer()  
    } 
})();